[ -----------------------------------------------------------------
  MEMBER.DATA.HEATMAP - Connor Blakeney
  Finds members with the following criteria.  For Dennis and his heatmap.

  Share Account
  Checking
  Debit Card
  Auto Loan
  1st Mort
  Home Equity
  Direct Deposit/ACH payroll deduction 
  Online Banking
  Bill Payer
  E-Statements
  Senior Checking

 3/06/24 - Connor Blakeney added age and branch. 
 4/18/24 - Connor Blakeney added credit score and income, removed e statements and bill pay due to char limit.  
  ----------------------------------------------------------------- ]

TARGET=ACCOUNT

DEFINE
 FOUNDSHARE          = CHARACTER
 AGGSHARE            = MONEY
 FOUNDCHECKING       = CHARACTER
 AGGCHECKING         = MONEY
 FOUNDDEBITCARD      = CHARACTER
 FOUNDLOANAUTO       = CHARACTER
 AGGLOAN             = MONEY
 FOUNDLOAN1STMTG     = CHARACTER
 FOUNDLOANHOMEEQUITY = CHARACTER
 FOUNDACH            = CHARACTER
 FOUNDONLINEBANKING  = CHARACTER
 FOUNDBILLPAY        = CHARACTER
 FOUNDESTATEMENTS    = CHARACTER
 FOUNDKASASA         = CHARACTER
 FOUNDLOANREALESTATE = CHARACTER
 FOUNDNEWACCOUNT     = CHARACTER
 FOUNDOVER18         = CHARACTER
 MBRNAME             = CHARACTER  
 MBRSTREET           = CHARACTER  
 MBRCITY             = CHARACTER  
 MBRSTATE            = CHARACTER  
 MBRZIP              = CHARACTER 
 MBRBRANCH           = NUMBER
 MBRAGE              = NUMBER
 HOLDER              = CHARACTER
 NEWNUM              = CHARACTER
 FINALSHARE          = CHARACTER
 FINALCHECKING       = CHARACTER
 FINALLOAN           = CHARACTER


 TOTALALLMEMBERS     = NUMBER
 TOTALNEWMEMBERS     = NUMBER
 TOTALNEWMEMBERS18   = NUMBER
 GROUPEDSERVICES     = NUMBER ARRAY(15,2)
 INDIVIDUALSERVICES  = NUMBER ARRAY(12,2)
 INCLUDEDETAILS      = CHARACTER
 X                   = NUMBER
 WHITESPACEPOS       = NUMBER
 FIRSTNUM            = NUMBER
 HEADERPRINT         = NUMBER
 CSCORE              = NUMBER 
 INCOME              = MONEY

END

SETUP 
 INCLUDEDETAILS=CHARACTERREAD("Include details? Y or N")
 HEADERPRINT = 0
END

SELECT
 ACCOUNT:NUMBER<"9000000000" AND								[Not a '9' Charge-Off Account]
 ACCOUNT:CLOSEDATE='--/--/--' AND								[Open Account]
 ANY SHARE WITH (SHARE:ID="01" AND SHARE:BALANCE>=$25.00) AND			[Share 1 with at least $25]
 NOT ANY SHARE WITH (SHARE:CHARGEOFFDATE<>'--/--/--') AND				[No Charged-Off Shares]
 NOT ANY LOAN WITH (LOAN:CHARGEOFFDATE<>'--/--/--') AND				[No Charged-Off Loans]
 NOT ANY NAME WITH (NAME:TYPE=00 AND NAME:DEATHDATE<>'--/--/--') AND		[No Primary w/ Death Date]
 NOT ANY COMMENT WITH (CHARACTERSEARCH(COMMENT:COMMENT,"BUNCO")>0) AND	[No Bunco Comment]
 NOT ANYWARNING(ACCOUNT,07) AND									[CHAPTER 7 BK]
 NOT ANYWARNING(ACCOUNT,11) AND									[CHAPTER 11 BK]
 NOT ANYWARNING(ACCOUNT,13) AND									[CHAPTER 13 BK]
 NOT ANYWARNING(ACCOUNT,14) AND									[BANKRUPT]
 NOT ANYWARNING(ACCOUNT,15) AND									[FRAUD ALERT]
 NOT ANYWARNING(ACCOUNT,16) AND									[CHARGED OFF LOAN]
 NOT ANYWARNING(ACCOUNT,17) AND									[CHARGED OFF SHARE]
 NOT ANYWARNING(ACCOUNT,18) AND									[CHG OFF CR/CD]
 NOT ANYWARNING(ACCOUNT,19) AND									[FORECLOSURE]
 NOT ANYWARNING(ACCOUNT,26) AND									[CHG OFF DUE TO CARD ACTIVITY]
 NOT ANYWARNING(ACCOUNT,28) AND									[CHARGE OFF - SIG CARD PULLED]
 NOT ANYWARNING(ACCOUNT,42) AND 								[DECEASED MEMBER]
 NOT (ACCOUNT:TYPE=04 OR ACCOUNT:TYPE=05 OR ACCOUNT:TYPE=06 OR ACCOUNT:TYPE=07) [NOT EMPLOYEE OR BOARD MEMBER]
 [ AND (ACCOUNT:OPENDATE > SYSTEMDATE - (365 * 10))]
END

PRINT TITLE="MEMBER DATA HEATMAP"
 IF HEADERPRINT= 0 THEN
 PRINT"Account No,Name,Savings,Check,Debit,Auto,1st Mtg,H Eqty,ACH,OnlBnkg,Kasasa,Street,City,State,Zip,Branch,Age,CreditScore,Income"

 HEADERPRINT         =  1
 FOUNDSHARE          = "N"
 FOUNDCHECKING       = "N"
 FOUNDDEBITCARD      = "N"
 FOUNDLOANAUTO       = "N"
 FOUNDLOAN1STMTG     = "N"
 FOUNDLOANHOMEEQUITY = "N"
 FOUNDACH            = "N"
 FOUNDONLINEBANKING  = "N"
 FOUNDBILLPAY        = "N"
 FOUNDESTATEMENTS    = "N"
 FOUNDKASASA         = "N"
 FOUNDLOANREALESTATE = "N"
 FOUNDNEWACCOUNT     = "N"
 FOUNDOVER18         = "N"
 AGGSHARE            = $0.00
 AGGCHECKING         = $0.00
 AGGLOAN             = $0.00
IF ACCOUNT:TYPE <> 0 THEN
 MBRNAME             = NAME:SHORTNAME
IF ACCOUNT:TYPE = 0 THEN
 MBRNAME             = NAME:FIRST+" "+NAME:LAST 
 WHITESPACEPOS       = CHARACTERSEARCH(MBRNAME,"")
 MBRSTREET           = NAME:STREET
 MBRCITY             = NAME:CITY
 MBRSTATE            = NAME:STATE
 MBRZIP              = NAME:ZIPCODE
 MBRBRANCH           = ACCOUNT:BRANCH  
 MBRAGE              = YEAR(SYSACTUALDATE)-YEAR(NAME:BIRTHDATE)


 FOR EACH SHARE WITH (SHARE:TYPE=0 AND
  SHARE:CLOSEDATE='--/--/--' AND
  SHARE:CHARGEOFFDATE='--/--/--' AND
  SHARE:OPENDATE>SYSTEMDATE-90)
 DO
   FOUNDNEWACCOUNT="Y"
 END

 FOR EACH NAME WITH (NAME:TYPE=00 AND
  NAME:BIRTHDATE<>'--/--/--' AND
  NAME:BIRTHDATE<=DATEOFFSET(SYSTEMDATE,-18*12,0))
 DO
   FOUNDOVER18="Y"
 END

 FOR EACH SHARE WITH (SHARE:SHARECODE<>1 AND 
  SHARE:CLOSEDATE='--/--/--' AND
  SHARE:CHARGEOFFDATE='--/--/--')
 DO
   FOUNDSHARE="Y"
   AGGSHARE = AGGSHARE + SHARE:BALANCE
 END

 FOR EACH SHARE WITH (SHARE:SHARECODE=1 AND
  SHARE:CLOSEDATE='--/--/--' AND
  SHARE:CHARGEOFFDATE='--/--/--')
 DO
   FOUNDCHECKING="Y"
   AGGCHECKING = AGGCHECKING + SHARE:BALANCE
 END

 FOR EACH CARD WITH (CARD:TYPE=15 AND
  CARD:CLOSEDATE='--/--/--' AND
  CARD:STATUS=1)
 DO
   FOUNDDEBITCARD="Y"
 END

 FOR EACH LOAN WITH (LOAN:CLOSEDATE='--/--/--' AND
  LOAN:CHARGEOFFDATE='--/--/--' AND
 (LOAN:TYPE=1 OR
  LOAN:TYPE=2 OR
  LOAN:TYPE=3 OR
  LOAN:TYPE=4 OR
  LOAN:TYPE=5 OR
  LOAN:TYPE=6 OR
  LOAN:TYPE=8 OR
  LOAN:TYPE=9 OR
  LOAN:TYPE=12 OR
  LOAN:TYPE=13 OR
  LOAN:TYPE=14 OR
  LOAN:TYPE=15 OR
  LOAN:TYPE=16 OR
  LOAN:TYPE=17))
 DO
   FOUNDLOANAUTO="Y"
   AGGLOAN = AGGLOAN + LOAN:BALANCE                     
 END

 FOR EACH LOAN WITH (LOAN:CLOSEDATE='--/--/--' AND
  LOAN:CHARGEOFFDATE='--/--/--' AND
 (LOAN:TYPE=20 OR
  LOAN:TYPE=22 OR
  LOAN:TYPE=38 OR
  LOAN:TYPE=40 OR
  LOAN:TYPE=41 OR
  LOAN:TYPE=44 OR
  LOAN:TYPE=45 OR
  LOAN:TYPE=46 OR
  LOAN:TYPE=47 OR
  LOAN:TYPE=48 OR
  LOAN:TYPE=49 OR
  LOAN:TYPE=81))
 DO
   FOUNDLOAN1STMTG="Y"
 END

 FOR EACH LOAN WITH (LOAN:CLOSEDATE='--/--/--' AND
  LOAN:CHARGEOFFDATE='--/--/--' AND
 (LOAN:TYPE=34 OR
  LOAN:TYPE=35 OR
  LOAN:TYPE=36 OR
  LOAN:TYPE=37 OR
  LOAN:TYPE=38 OR
  LOAN:TYPE=39))
 DO
   FOUNDLOANHOMEEQUITY="Y" 
 END

 FOR EACH TRACKING WITH (TRACKING:TYPE=92 AND
  TRACKING:USERDATE1>=(SYSTEMDATE-40))
 DO
   FOUNDACH="Y"
 END

 FOR EACH TRACKING WITH (TRACKING:TYPE=90)
 DO
   FOUNDONLINEBANKING="Y"
   IF TRACKING:USERCHAR2<>"Basic" THEN FOUNDBILLPAY="Y"
 END

 CSCORE = 0

 FOR EACH LOANAPP 
	DO 
	 FOR EACH LOANAPP TRACKING WITH LOANAPP TRACKING:TYPE=52
		DO 
		 CSCORE = LOANAPP TRACKING:USERCODE1
		END
	END 

 INCOME = $0.00

 FOR EACH LOANAPP 
	DO 
	 FOR EACH LOANAPP PERSON
		DO 
		 INCOME = (LOANAPP PERSON:CURREMPGROSSMONTHLYPAY * 12)
		END
	END 
		

 IF ANYWARNING(ACCOUNT,27) THEN FOUNDESTATEMENTS="Y"

 FOR EACH SHARE WITH (SHARE:TYPE=23 OR SHARE:TYPE=25 OR SHARE:TYPE=27)
 DO
   FOUNDKASASA="Y"
 END

 IF FOUNDLOAN1STMTG="Y" OR FOUNDLOANHOMEEQUITY="Y" THEN FOUNDLOANREALESTATE="Y"


HOLDER = FORMAT("########9.99",AGGSHARE)

WHILE CHARACTERSEARCH(HOLDER," ") <> 0 
DO
FIRSTNUM= CHARACTERSEARCH(HOLDER," ")
HOLDER=SEGMENT(HOLDER,FIRSTNUM+1,LENGTH(HOLDER))
END
FINALSHARE = HOLDER     

HOLDER = FORMAT("########9.99",AGGCHECKING)

WHILE CHARACTERSEARCH(HOLDER," ") <> 0 
DO
FIRSTNUM= CHARACTERSEARCH(HOLDER," ")
HOLDER=SEGMENT(HOLDER,FIRSTNUM+1,LENGTH(HOLDER))
END
FINALCHECKING = HOLDER

HOLDER = FORMAT("########9.99",AGGLOAN)          

WHILE CHARACTERSEARCH(HOLDER," ") <> 0 
DO
FIRSTNUM= CHARACTERSEARCH(HOLDER," ")
HOLDER=SEGMENT(HOLDER,FIRSTNUM+1,LENGTH(HOLDER))
END
FINALLOAN = HOLDER          

 IF INCLUDEDETAILS="Y" THEN 
 DO
   COL=001 ACCOUNT:NUMBER+","+
   MBRNAME+","+
   FINALSHARE +","+
   FINALCHECKING +","+
   FOUNDDEBITCARD+","+
   FINALLOAN +","+
   FOUNDLOAN1STMTG+","+
   FOUNDLOANHOMEEQUITY+","+
   FOUNDACH+","+
   FOUNDONLINEBANKING+","+
   FOUNDKASASA+","+
   MBRSTREET+","+
   MBRCITY+","+
   MBRSTATE+","+
   MBRZIP+","+
   FORMAT("99",MBRBRANCH)+","+
   FORMAT("#99",MBRAGE)+","+
   FORMAT("999",CSCORE)+","+
   FORMAT("+####99999.99",INCOME)
   NEWLINE
 END
 TOTALALLMEMBERS=TOTALALLMEMBERS+1

 IF FOUNDSHARE="Y" AND FOUNDCHECKING="N" AND FOUNDLOANAUTO="N" AND FOUNDLOANREALESTATE="N" THEN GROUPEDSERVICES(0,0)=GROUPEDSERVICES(0,0)+1
 IF FOUNDSHARE="N" AND FOUNDCHECKING="Y" AND FOUNDLOANAUTO="N" AND FOUNDLOANREALESTATE="N" THEN GROUPEDSERVICES(1,0)=GROUPEDSERVICES(1,0)+1
 IF FOUNDSHARE="N" AND FOUNDCHECKING="N" AND FOUNDLOANAUTO="Y" AND FOUNDLOANREALESTATE="N" THEN GROUPEDSERVICES(2,0)=GROUPEDSERVICES(2,0)+1
 IF FOUNDSHARE="N" AND FOUNDCHECKING="N" AND FOUNDLOANAUTO="N" AND FOUNDLOANREALESTATE="Y" THEN GROUPEDSERVICES(3,0)=GROUPEDSERVICES(3,0)+1
 IF FOUNDSHARE="Y" AND FOUNDCHECKING="Y" AND FOUNDLOANAUTO="N" AND FOUNDLOANREALESTATE="N" THEN GROUPEDSERVICES(4,0)=GROUPEDSERVICES(4,0)+1
 IF FOUNDSHARE="Y" AND FOUNDCHECKING="N" AND FOUNDLOANAUTO="Y" AND FOUNDLOANREALESTATE="N" THEN GROUPEDSERVICES(5,0)=GROUPEDSERVICES(5,0)+1
 IF FOUNDSHARE="Y" AND FOUNDCHECKING="N" AND FOUNDLOANAUTO="N" AND FOUNDLOANREALESTATE="Y" THEN GROUPEDSERVICES(6,0)=GROUPEDSERVICES(6,0)+1
 IF FOUNDSHARE="N" AND FOUNDCHECKING="Y" AND FOUNDLOANAUTO="Y" AND FOUNDLOANREALESTATE="N" THEN GROUPEDSERVICES(7,0)=GROUPEDSERVICES(7,0)+1
 IF FOUNDSHARE="N" AND FOUNDCHECKING="Y" AND FOUNDLOANAUTO="N" AND FOUNDLOANREALESTATE="Y" THEN GROUPEDSERVICES(8,0)=GROUPEDSERVICES(8,0)+1
 IF FOUNDSHARE="N" AND FOUNDCHECKING="N" AND FOUNDLOANAUTO="Y" AND FOUNDLOANREALESTATE="Y" THEN GROUPEDSERVICES(9,0)=GROUPEDSERVICES(9,0)+1
 IF FOUNDSHARE="Y" AND FOUNDCHECKING="Y" AND FOUNDLOANAUTO="Y" AND FOUNDLOANREALESTATE="N" THEN GROUPEDSERVICES(10,0)=GROUPEDSERVICES(10,0)+1
 IF FOUNDSHARE="Y" AND FOUNDCHECKING="Y" AND FOUNDLOANAUTO="N" AND FOUNDLOANREALESTATE="Y" THEN GROUPEDSERVICES(11,0)=GROUPEDSERVICES(11,0)+1
 IF FOUNDSHARE="Y" AND FOUNDCHECKING="N" AND FOUNDLOANAUTO="Y" AND FOUNDLOANREALESTATE="Y" THEN GROUPEDSERVICES(12,0)=GROUPEDSERVICES(12,0)+1
 IF FOUNDSHARE="N" AND FOUNDCHECKING="Y" AND FOUNDLOANAUTO="Y" AND FOUNDLOANREALESTATE="Y" THEN GROUPEDSERVICES(13,0)=GROUPEDSERVICES(13,0)+1
 IF FOUNDSHARE="Y" AND FOUNDCHECKING="Y" AND FOUNDLOANAUTO="Y" AND FOUNDLOANREALESTATE="Y" THEN GROUPEDSERVICES(14,0)=GROUPEDSERVICES(14,0)+1

 IF FOUNDSHARE="Y"          THEN INDIVIDUALSERVICES(0,0)=INDIVIDUALSERVICES(0,0)+1
 IF FOUNDCHECKING="Y"       THEN INDIVIDUALSERVICES(1,0)=INDIVIDUALSERVICES(1,0)+1 
 IF FOUNDDEBITCARD="Y"      THEN INDIVIDUALSERVICES(2,0)=INDIVIDUALSERVICES(2,0)+1 
 IF FOUNDLOANAUTO="Y"       THEN INDIVIDUALSERVICES(3,0)=INDIVIDUALSERVICES(3,0)+1 
 IF FOUNDLOAN1STMTG="Y"     THEN INDIVIDUALSERVICES(4,0)=INDIVIDUALSERVICES(4,0)+1
 IF FOUNDLOANHOMEEQUITY="Y" THEN INDIVIDUALSERVICES(5,0)=INDIVIDUALSERVICES(5,0)+1 
 IF FOUNDACH="Y"            THEN INDIVIDUALSERVICES(6,0)=INDIVIDUALSERVICES(6,0)+1 
 IF FOUNDONLINEBANKING="Y"  THEN INDIVIDUALSERVICES(7,0)=INDIVIDUALSERVICES(7,0)+1 
 IF FOUNDBILLPAY="Y"        THEN INDIVIDUALSERVICES(8,0)=INDIVIDUALSERVICES(8,0)+1
 IF FOUNDESTATEMENTS="Y"    THEN INDIVIDUALSERVICES(9,0)=INDIVIDUALSERVICES(9,0)+1 
 IF FOUNDKASASA="Y"         THEN INDIVIDUALSERVICES(10,0)=INDIVIDUALSERVICES(10,0)+1 
 IF FOUNDLOANREALESTATE="Y" THEN INDIVIDUALSERVICES(11,0)=INDIVIDUALSERVICES(11,0)+1 

 IF FOUNDNEWACCOUNT="Y" THEN
 DO
   TOTALNEWMEMBERS=TOTALNEWMEMBERS+1

   IF FOUNDSHARE="Y" AND FOUNDCHECKING="N" AND FOUNDLOANAUTO="N" AND FOUNDLOANREALESTATE="N" THEN GROUPEDSERVICES(0,1)=GROUPEDSERVICES(0,1)+1
   IF FOUNDSHARE="N" AND FOUNDCHECKING="Y" AND FOUNDLOANAUTO="N" AND FOUNDLOANREALESTATE="N" THEN GROUPEDSERVICES(1,1)=GROUPEDSERVICES(1,1)+1
   IF FOUNDSHARE="N" AND FOUNDCHECKING="N" AND FOUNDLOANAUTO="Y" AND FOUNDLOANREALESTATE="N" THEN GROUPEDSERVICES(2,1)=GROUPEDSERVICES(2,1)+1
   IF FOUNDSHARE="N" AND FOUNDCHECKING="N" AND FOUNDLOANAUTO="N" AND FOUNDLOANREALESTATE="Y" THEN GROUPEDSERVICES(3,1)=GROUPEDSERVICES(3,1)+1
   IF FOUNDSHARE="Y" AND FOUNDCHECKING="Y" AND FOUNDLOANAUTO="N" AND FOUNDLOANREALESTATE="N" THEN GROUPEDSERVICES(4,1)=GROUPEDSERVICES(4,1)+1
   IF FOUNDSHARE="Y" AND FOUNDCHECKING="N" AND FOUNDLOANAUTO="Y" AND FOUNDLOANREALESTATE="N" THEN GROUPEDSERVICES(5,1)=GROUPEDSERVICES(5,1)+1
   IF FOUNDSHARE="Y" AND FOUNDCHECKING="N" AND FOUNDLOANAUTO="N" AND FOUNDLOANREALESTATE="Y" THEN GROUPEDSERVICES(6,1)=GROUPEDSERVICES(6,1)+1
   IF FOUNDSHARE="N" AND FOUNDCHECKING="Y" AND FOUNDLOANAUTO="Y" AND FOUNDLOANREALESTATE="N" THEN GROUPEDSERVICES(7,1)=GROUPEDSERVICES(7,1)+1
   IF FOUNDSHARE="N" AND FOUNDCHECKING="Y" AND FOUNDLOANAUTO="N" AND FOUNDLOANREALESTATE="Y" THEN GROUPEDSERVICES(8,1)=GROUPEDSERVICES(8,1)+1
   IF FOUNDSHARE="N" AND FOUNDCHECKING="N" AND FOUNDLOANAUTO="Y" AND FOUNDLOANREALESTATE="Y" THEN GROUPEDSERVICES(9,1)=GROUPEDSERVICES(9,1)+1
   IF FOUNDSHARE="Y" AND FOUNDCHECKING="Y" AND FOUNDLOANAUTO="Y" AND FOUNDLOANREALESTATE="N" THEN GROUPEDSERVICES(10,1)=GROUPEDSERVICES(10,1)+1
   IF FOUNDSHARE="Y" AND FOUNDCHECKING="Y" AND FOUNDLOANAUTO="N" AND FOUNDLOANREALESTATE="Y" THEN GROUPEDSERVICES(11,1)=GROUPEDSERVICES(11,1)+1
   IF FOUNDSHARE="Y" AND FOUNDCHECKING="N" AND FOUNDLOANAUTO="Y" AND FOUNDLOANREALESTATE="Y" THEN GROUPEDSERVICES(12,1)=GROUPEDSERVICES(12,1)+1
   IF FOUNDSHARE="N" AND FOUNDCHECKING="Y" AND FOUNDLOANAUTO="Y" AND FOUNDLOANREALESTATE="Y" THEN GROUPEDSERVICES(13,1)=GROUPEDSERVICES(13,1)+1
   IF FOUNDSHARE="Y" AND FOUNDCHECKING="Y" AND FOUNDLOANAUTO="Y" AND FOUNDLOANREALESTATE="Y" THEN GROUPEDSERVICES(14,1)=GROUPEDSERVICES(14,1)+1

   IF FOUNDSHARE="Y"          THEN INDIVIDUALSERVICES(0,1)=INDIVIDUALSERVICES(0,1)+1
   IF FOUNDCHECKING="Y"       THEN INDIVIDUALSERVICES(1,1)=INDIVIDUALSERVICES(1,1)+1 
   IF FOUNDDEBITCARD="Y"      THEN INDIVIDUALSERVICES(2,1)=INDIVIDUALSERVICES(2,1)+1 
   IF FOUNDLOANAUTO="Y"       THEN INDIVIDUALSERVICES(3,1)=INDIVIDUALSERVICES(3,1)+1 
   IF FOUNDLOAN1STMTG="Y"     THEN INDIVIDUALSERVICES(4,1)=INDIVIDUALSERVICES(4,1)+1
   IF FOUNDLOANHOMEEQUITY="Y" THEN INDIVIDUALSERVICES(5,1)=INDIVIDUALSERVICES(5,1)+1 
   IF FOUNDACH="Y"            THEN INDIVIDUALSERVICES(6,1)=INDIVIDUALSERVICES(6,1)+1 
   IF FOUNDONLINEBANKING="Y"  THEN INDIVIDUALSERVICES(7,1)=INDIVIDUALSERVICES(7,1)+1 
   IF FOUNDBILLPAY="Y"        THEN INDIVIDUALSERVICES(8,1)=INDIVIDUALSERVICES(8,1)+1
   IF FOUNDESTATEMENTS="Y"    THEN INDIVIDUALSERVICES(9,1)=INDIVIDUALSERVICES(9,1)+1 
   IF FOUNDKASASA="Y"         THEN INDIVIDUALSERVICES(10,1)=INDIVIDUALSERVICES(10,1)+1 
   IF FOUNDLOANREALESTATE="Y" THEN INDIVIDUALSERVICES(11,1)=INDIVIDUALSERVICES(11,1)+1 
 END

 IF FOUNDNEWACCOUNT="Y" AND FOUNDOVER18="Y" THEN
 DO
   TOTALNEWMEMBERS18=TOTALNEWMEMBERS18+1

   IF FOUNDSHARE="Y" AND FOUNDCHECKING="N" AND FOUNDLOANAUTO="N" AND FOUNDLOANREALESTATE="N" THEN GROUPEDSERVICES(0,2)=GROUPEDSERVICES(0,2)+1
   IF FOUNDSHARE="N" AND FOUNDCHECKING="Y" AND FOUNDLOANAUTO="N" AND FOUNDLOANREALESTATE="N" THEN GROUPEDSERVICES(1,2)=GROUPEDSERVICES(1,2)+1
   IF FOUNDSHARE="N" AND FOUNDCHECKING="N" AND FOUNDLOANAUTO="Y" AND FOUNDLOANREALESTATE="N" THEN GROUPEDSERVICES(2,2)=GROUPEDSERVICES(2,2)+1
   IF FOUNDSHARE="N" AND FOUNDCHECKING="N" AND FOUNDLOANAUTO="N" AND FOUNDLOANREALESTATE="Y" THEN GROUPEDSERVICES(3,2)=GROUPEDSERVICES(3,2)+1
   IF FOUNDSHARE="Y" AND FOUNDCHECKING="Y" AND FOUNDLOANAUTO="N" AND FOUNDLOANREALESTATE="N" THEN GROUPEDSERVICES(4,2)=GROUPEDSERVICES(4,2)+1
   IF FOUNDSHARE="Y" AND FOUNDCHECKING="N" AND FOUNDLOANAUTO="Y" AND FOUNDLOANREALESTATE="N" THEN GROUPEDSERVICES(5,2)=GROUPEDSERVICES(5,2)+1
   IF FOUNDSHARE="Y" AND FOUNDCHECKING="N" AND FOUNDLOANAUTO="N" AND FOUNDLOANREALESTATE="Y" THEN GROUPEDSERVICES(6,2)=GROUPEDSERVICES(6,2)+1
   IF FOUNDSHARE="N" AND FOUNDCHECKING="Y" AND FOUNDLOANAUTO="Y" AND FOUNDLOANREALESTATE="N" THEN GROUPEDSERVICES(7,2)=GROUPEDSERVICES(7,2)+1
   IF FOUNDSHARE="N" AND FOUNDCHECKING="Y" AND FOUNDLOANAUTO="N" AND FOUNDLOANREALESTATE="Y" THEN GROUPEDSERVICES(8,2)=GROUPEDSERVICES(8,2)+1
   IF FOUNDSHARE="N" AND FOUNDCHECKING="N" AND FOUNDLOANAUTO="Y" AND FOUNDLOANREALESTATE="Y" THEN GROUPEDSERVICES(9,2)=GROUPEDSERVICES(9,2)+1
   IF FOUNDSHARE="Y" AND FOUNDCHECKING="Y" AND FOUNDLOANAUTO="Y" AND FOUNDLOANREALESTATE="N" THEN GROUPEDSERVICES(10,2)=GROUPEDSERVICES(10,2)+1
   IF FOUNDSHARE="Y" AND FOUNDCHECKING="Y" AND FOUNDLOANAUTO="N" AND FOUNDLOANREALESTATE="Y" THEN GROUPEDSERVICES(11,2)=GROUPEDSERVICES(11,2)+1
   IF FOUNDSHARE="Y" AND FOUNDCHECKING="N" AND FOUNDLOANAUTO="Y" AND FOUNDLOANREALESTATE="Y" THEN GROUPEDSERVICES(12,2)=GROUPEDSERVICES(12,2)+1
   IF FOUNDSHARE="N" AND FOUNDCHECKING="Y" AND FOUNDLOANAUTO="Y" AND FOUNDLOANREALESTATE="Y" THEN GROUPEDSERVICES(13,2)=GROUPEDSERVICES(13,2)+1
   IF FOUNDSHARE="Y" AND FOUNDCHECKING="Y" AND FOUNDLOANAUTO="Y" AND FOUNDLOANREALESTATE="Y" THEN GROUPEDSERVICES(14,2)=GROUPEDSERVICES(14,2)+1

   IF FOUNDSHARE="Y"          THEN INDIVIDUALSERVICES(0,2)=INDIVIDUALSERVICES(0,2)+1
   IF FOUNDCHECKING="Y"       THEN INDIVIDUALSERVICES(1,2)=INDIVIDUALSERVICES(1,2)+1 
   IF FOUNDDEBITCARD="Y"      THEN INDIVIDUALSERVICES(2,2)=INDIVIDUALSERVICES(2,2)+1 
   IF FOUNDLOANAUTO="Y"       THEN INDIVIDUALSERVICES(3,2)=INDIVIDUALSERVICES(3,2)+1 
   IF FOUNDLOAN1STMTG="Y"     THEN INDIVIDUALSERVICES(4,2)=INDIVIDUALSERVICES(4,2)+1
   IF FOUNDLOANHOMEEQUITY="Y" THEN INDIVIDUALSERVICES(5,2)=INDIVIDUALSERVICES(5,2)+1 
   IF FOUNDACH="Y"            THEN INDIVIDUALSERVICES(6,2)=INDIVIDUALSERVICES(6,2)+1 
   IF FOUNDONLINEBANKING="Y"  THEN INDIVIDUALSERVICES(7,2)=INDIVIDUALSERVICES(7,2)+1 
   IF FOUNDBILLPAY="Y"        THEN INDIVIDUALSERVICES(8,2)=INDIVIDUALSERVICES(8,2)+1
   IF FOUNDESTATEMENTS="Y"    THEN INDIVIDUALSERVICES(9,2)=INDIVIDUALSERVICES(9,2)+1 
   IF FOUNDKASASA="Y"         THEN INDIVIDUALSERVICES(10,2)=INDIVIDUALSERVICES(10,2)+1 
   IF FOUNDLOANREALESTATE="Y" THEN INDIVIDUALSERVICES(11,2)=INDIVIDUALSERVICES(11,2)+1 
 END


END

TOTAL
 HEADER=""
 IF INCLUDEDETAILS="Y" THEN
 DO
   PRINT "---------------------------------------------------------------------------------------------------------------------------"
   NEWLINE
   NEWLINE
   NEWPAGE
 END

 FOR X=0 TO 2
 DO
   IF X=0 THEN
   DO
     PRINT "Total members:"
     COL=070 TOTALALLMEMBERS
     NEWLINE
     NEWLINE
   END
   ELSE
   DO 
     IF X=1 THEN
     DO
       NEWPAGE
       PRINT "New Member Totals (Account < 90 days old):"
       COL=070 TOTALNEWMEMBERS
       NEWLINE
       NEWLINE
     END
     ELSE
     DO
       NEWPAGE
       PRINT "New Member Over 18 Totals (Account < 90 days old):"
       COL=070 TOTALNEWMEMBERS18
       NEWLINE
       NEWLINE
     END
   END

   PRINT "Grouped Service Totals:"

   NEWLINE
   NEWLINE
   COL=001 "Having Only Share: "
   COL=070 GROUPEDSERVICES(0,X)
   NEWLINE
   COL=001 "Having Only Checking: "
   COL=070 GROUPEDSERVICES(1,X)
   NEWLINE
   COL=001 "Having Only Auto Loan: "
   COL=070 GROUPEDSERVICES(2,X)
   NEWLINE
   COL=001 "Having Only Mortgage Loan: "
   COL=070 GROUPEDSERVICES(3,X)
   NEWLINE
   COL=001 "Having Share / Checking: "
   COL=070 GROUPEDSERVICES(4,X)
   NEWLINE
   COL=001 "Having Share / Auto Loan: "
   COL=070 GROUPEDSERVICES(5,X)
   NEWLINE
   COL=001 "Having Share / Mortgage Loan: "
   COL=070 GROUPEDSERVICES(6,X)
   NEWLINE
   COL=001 "Having Checking / Auto Loan: "
   COL=070 GROUPEDSERVICES(7,X)
   NEWLINE
   COL=001 "Having Checking / Mortgage Loan: "
   COL=070 GROUPEDSERVICES(8,X)
   NEWLINE
   COL=001 "Having Auto Loan / Mortgage Loan: "
   COL=070 GROUPEDSERVICES(9,X)
   NEWLINE
   COL=001 "Having Share / Checking / Auto Loan: "
   COL=070 GROUPEDSERVICES(10,X)
   NEWLINE
   COL=001 "Having Share / Checking / Mortgage Loan: "
   COL=070 GROUPEDSERVICES(11,X)
   NEWLINE
   COL=001 "Having Share / Auto Loan / Mortgage Loan: "
   COL=070 GROUPEDSERVICES(12,X)
   NEWLINE
   COL=001 "Having Checking / Auto Loan / Mortgage Loan: "
   COL=070 GROUPEDSERVICES(13,X)
   NEWLINE
   COL=001 "Having Share / Checking / Auto Loan /Mortgage Loan: "
   COL=070 GROUPEDSERVICES(14,X)
   NEWLINE
   NEWLINE
   COL=001 "Individual Totals:"
   NEWLINE
   NEWLINE
   COL=001 "Found Share: "
   COL=070 INDIVIDUALSERVICES(0,X)
   NEWLINE
   COL=001 "Found Checking: "
   COL=070 INDIVIDUALSERVICES(1,X)
   NEWLINE
   COL=001 "Found Debit Card: "
   COL=070 INDIVIDUALSERVICES(2,X)
   NEWLINE
   COL=001 "Found Auto Loan: "
   COL=070 INDIVIDUALSERVICES(3,X)
   NEWLINE
   COL=001 "Found First Mortgage: "
   COL=070 INDIVIDUALSERVICES(4,X)
   NEWLINE
   COL=001 "Found Home Equity: "
   COL=070 INDIVIDUALSERVICES(5,X)
   NEWLINE
   COL=001 "Found First Mortgage or Home Equity: "
   COL=070 INDIVIDUALSERVICES(11,X)
   NEWLINE
   COL=001 "Found ACH: "
   COL=070 INDIVIDUALSERVICES(6,X)
   NEWLINE
   COL=001 "Found Online Banking: "
   COL=070 INDIVIDUALSERVICES(7,X)
   NEWLINE
   COL=001 "Found Bill Pay: "
   COL=070 INDIVIDUALSERVICES(8,X)
   NEWLINE
   COL=001 "Found E-Statement: "
   COL=070 INDIVIDUALSERVICES(9,X)
   NEWLINE
   COL=001 "Found Kasasa  Checking: "
   COL=070 INDIVIDUALSERVICES(10,X)
   NEWLINE
   COL=065 "------"
   NEWLINE
   COL=070 INDIVIDUALSERVICES(0,X)+INDIVIDUALSERVICES(1,X)+INDIVIDUALSERVICES(2,X)+
           INDIVIDUALSERVICES(3,X)+INDIVIDUALSERVICES(4,X)+INDIVIDUALSERVICES(5,X)+
           INDIVIDUALSERVICES(11,X)+INDIVIDUALSERVICES(6,X)+INDIVIDUALSERVICES(7,X)+
           INDIVIDUALSERVICES(8,X)+INDIVIDUALSERVICES(9,X)+INDIVIDUALSERVICES(10,X)
   NEWLINE
   NEWLINE
   NEWLINE

   IF X=2 THEN
   DO
     COL=001 "Mike Neill Metrics:"
     NEWLINE 
     COL=001 "(3) Number of Single Service Members: "
     COL=070 GROUPEDSERVICES(0,0)
     NEWLINE
     COL=001 "(4) Product per Member in 1st 90 days ("
     COL=050 INDIVIDUALSERVICES(0,X)+INDIVIDUALSERVICES(1,X)+INDIVIDUALSERVICES(2,X)+
             INDIVIDUALSERVICES(3,X)+INDIVIDUALSERVICES(4,X)+INDIVIDUALSERVICES(5,X)+
             INDIVIDUALSERVICES(11,X)+INDIVIDUALSERVICES(6,X)+INDIVIDUALSERVICES(7,X)+
             INDIVIDUALSERVICES(8,X)+INDIVIDUALSERVICES(9,X)+INDIVIDUALSERVICES(10,X)
     COL=052 "/"
     COL=058 TOTALNEWMEMBERS18
     COL=060 "):"
     COL=070 (INDIVIDUALSERVICES(0,X)+INDIVIDUALSERVICES(1,X)+INDIVIDUALSERVICES(2,X)+
              INDIVIDUALSERVICES(3,X)+INDIVIDUALSERVICES(4,X)+INDIVIDUALSERVICES(5,X)+
              INDIVIDUALSERVICES(11,X)+INDIVIDUALSERVICES(6,X)+INDIVIDUALSERVICES(7,X)+
              INDIVIDUALSERVICES(8,X)+INDIVIDUALSERVICES(9,X)+INDIVIDUALSERVICES(10,X))/(TOTALNEWMEMBERS18*100)
     NEWLINE
  END

 END



END




[ Report Format:

  Account No  Name              Share?  Check?  Debit?  Auto?  RealEst?  ACH?  OnlBnkg?  BillPay?  E-Stmt?  
  xxxxxxxxxx  xxxxxxxxxxxxxxxx       x       x       x      x         x     x        x         x         x

  Account No  Name              Share?  Check?  Debit?  Auto?  1st Mtg?  H Eqty?  ACH?  OnlBnkg?  BillPay?  E-Stmt?  Sen Chk?  
  xxxxxxxxxx  xxxxxxxxxxxxxxxx       x       x       x      x         x        x     x        x         x         x         x

                                                                  ------
  (4) Product per Member in 1st 90 days ( 23,456,789 / 12345 ): 222.516%
  000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000111111111111111111111111111111111
  000000000111111111122222222223333333333444444444455555555556666666666777777777788888888889999999999000000000011111111112222222222333
  123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012
]



